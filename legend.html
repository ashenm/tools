---
lang: en
title: Index
desc: List of instructional tools available with a short description
keywords: ashen, gunaratne, ashen m. gunaratne, educational, tools, materials, index
---

{%- capture metadata -%}
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="{{ page.desc }}" />
  <meta name="keywords" content="{{ page.keywords }}" />
  <meta name="author" content="{{ site.author }}" />

  <title>{{ page.title }}</title>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous" />

  <style type="text/css">
    
    table {
      margin: 20px;
    }

    caption {
      text-align: center;
    }

  </style>
{%- endcapture -%}

{%- capture scripts -%}
  <script type="text/javascript">

    // extract username and repository
    const [_, username, repository] = location.href.match(/(\w+)\W\w+\W\w+\W(\w+)/);

    // global configuration
    const config = {
      username: username,
      repository: repository,
      excludes: ['images', 'README.md', '404.html', 'index.html', 'legend.html']
    };

    // on DOM ready
    document.onreadystatechange = function() {
      if (document.readyState === 'interactive') {
        dir(config.username, config.repository, '', render);
      }
    };

    /**
     * Execute parameterised function with an array of objects
     * each object representing an item in the repository
     */
    function dir(username, repository, path, callback) {

      const xhr = new XMLHttpRequest();
      const route = `https://api.github.com/repos/${username}/${repository}/contents/${path}`;

      xhr.responseType = 'json';
      xhr.onreadystatechange = function() {

        if (xhr.readyState !== XMLHttpRequest.DONE) {
          return
        }

        if (xhr.status !== 200) {
          callback(xhr.status);
          return
        }
 
        callback(null, path, xhr.response);

      };

      xhr.open('GET', route);
      xhr.send(null);

    }

    /**
     * Execute parameterised function with an object which
     * each property corresponds to a YAML front matter variable
     */
    function metadata(url, refID, callback) {

      const data = {};
      const xhr = new XMLHttpRequest();

      xhr.responseType = 'text';
      xhr.onreadystatechange = function() {

        if (xhr.readyState !== XMLHttpRequest.DONE)
          return;

        // extract front matter
        const fm = xhr.response.match(/---\s([^]*)\s---/);

        // handle non-existent font matter
        if (!fm) {
          callback(new TypeError(), null, refID);
          return;
        }

        // construct hash table
        fm.pop().split(/\r\n|\r|\n/).forEach(row => {
          const [_, key, value] = row.match(/(\S+): ([\s\S]+)/);
          data[key] = value;
        });

        // execute callback with invoker reference
        // and extracted YAML front matter object
        callback(null, data, refID);

      };

      xhr.open('GET', url);
      // TODO: `Range` header not allowed for CORS by any GitHub CDN
      // Spin up a proxy to avoid unnecessary bandwidth usage
      // xhr.setRequestHeader('Range', 'bytes=0-256');
      xhr.send(null);

    }

    /**
     * Render repository listing
     */
    function render(error, path, files) {
      files.forEach(file => {

        // ignore dot and underscore files
        if (file.name.match(/^[._]/)) {
          return;
        }

        // also omit predefined files
        if (config.excludes.indexOf(file.name) > -1) {
          return;
        }

        // recursively list sub-directory content
        if (file.type === 'dir') {
          dir(config.username, config.repository, `${path}/${file.name}`, render);
          return;
        }

        const node = document.querySelector('tbody');
        const row = document.createElement('tr');
        const title = document.createElement('td');
        const desc = document.createElement('td');
        const link = document.createElement('a');
        const ref = file.name.replace(/\.\w+/, '');

        row.id = ref;
        link.rel = `next`;
        link.href = `//${location.host}/${config.repository}${path}/${ref}`;

        title.appendChild(link);
        row.appendChild(title);
        row.appendChild(desc);
        node.appendChild(row);

        metadata(file.download_url, ref, (error, data, refID) => {

          const node = document.getElementById(refID);
          const metadata = Object.assign({}, data || {
            title: refID,
            desc: '<em>No description available<em>'
          });

          node.firstElementChild.firstChild.innerText = metadata.title;
          node.lastElementChild.innerHTML = metadata.desc;

        });

      });
    }

  </script>
{%- endcapture -%}

{%- capture body -%}
  <main>
    <div class="container-fluid">
      <div class="row justify-content-center">
        <div class="col-md-6">
          <table class="table table-hover table-responsive-sm">
            <caption>List of Tools</caption>
            <thead>
              <tr>
                <th scope="col">Tool</th>
                <th scope="col">Description</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </main>
{%- endcapture -%}

{%- include base.html -%}
