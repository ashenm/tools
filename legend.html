---
lang: en
title: Index
desc: List of instructional tools available with a short description
keywords: ashen m. gunaratne educational tools materials index
---

{%- capture metadata -%}
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="{{ page.desc }}" />
  <meta name="keywords" content="{{ page.keywords }}" />
  <meta name="author" content="{{ site.author }}" />
  <title>{{ page.title }}</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous" />
  <style type="text/css">
    
    table {
      margin: 20px;
    }

    caption {
      text-align: center;
    }

  </style>
{%- endcapture -%}

{%- capture scripts -%}
  <script type="text/javascript">

    const excludes = ['README.md', '404.html', 'index.html', 'legend.html'];

    document.onreadystatechange = function() {
      if (document.readyState === 'interactive') {

        // extract username and repositoy
        // const path = location.href.match(/(\w+)\W\w+\W\w+\W(\w+)/);
        // const username = path[0];
        // const repositoy = path[1];

        const username = 'ashenm';
        const repositoy = 'tools';

        dir(username, repositoy, function(error, files) {
          files.forEach(file => {

            // ignore dot and underscore files
            if (file.name.match(/^[._]/)) {
              return;
            }

            // also omit parameterised files
            if (excludes.indexOf(file.name) > -1) {
              return;
            }

            const node = document.querySelector('tbody');
            const row = document.createElement('tr');
            const title = document.createElement('td');
            const desc = document.createElement('td');
            const link = document.createElement('a');
            const ref = file.name.replace(/\.\w+/, '');

            row.id = ref;
            link.rel = `external`;
            link.href = `//${location.host}/${repositoy}/${ref}`;

            title.appendChild(link);
            row.appendChild(title);
            row.appendChild(desc);
            node.appendChild(row);

            metadata(file.download_url, ref, (error, refID, metadata) => {

              if (error) {
                return;
              }

              const node = document.getElementById(refID);

              node.firstElementChild.firstChild.innerText = metadata.title;
              node.lastElementChild.innerText = metadata.desc;

            });

          });
        });

      }
    };

    /**
     * Execute parameterised function with an array of objects
     * each object representing an item in the repository
     */
    function dir(username, repository, callback) {

      const xhr = new XMLHttpRequest();
      const route = `https://api.github.com/repos/${username}/${repository}/contents`;

      xhr.responseType = 'json';
      xhr.onreadystatechange = function() {
        if (xhr.readyState === XMLHttpRequest.DONE) {
          if (xhr.status === 200) {
            callback(null, xhr.response);
          } else {
            callback(xhr.status);
          }
        }
      }
      xhr.open('GET', route);
      xhr.send(null);

    }

    /**
     * Execute parameterised function with an object
     * where each property corresponding to YAML front matter variables 
     */
    function metadata(url, refID, callback) {

      const metadata = {};
      const xhr = new XMLHttpRequest;

      xhr.responseType = 'text';
      xhr.onreadystatechange = function() {
        if (xhr.readyState === XMLHttpRequest.DONE) {
          // extract front matter and construct hash table
          if (fm = xhr.response.match(/---\s([^]*)\s---/)) {
            fm.pop().split(/\r\n|\r|\n/).forEach(meta => {
              const extract = meta.match(/(\S+): ([\s\S]+)/);
              metadata[extract[1]] = extract[2];
            });
            callback(null, refID, metadata);
          } else {
            callback(xhr.status);
          }
        }
      };

      xhr.open('GET', url);
      // TODO: `Range` header not allowed for CORS by any GitHub CDN
      // Spin up a proxy to avoid unnecessary bandwidth usage
      // xhr.setRequestHeader('Range', 'bytes=0-256');
      xhr.send(null);

    }

  </script>
{%- endcapture -%}

{%- capture body -%}
  <main>
    <div class="container-fluid">
      <div class="row justify-content-center">
        <div class="col-md-6">
          <table class="table table-hover table-responsive-sm">
            <caption>List of Tools</caption>
            <thead>
              <tr>
                <th scope="col">Tool</th>
                <th scope="col">Description</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </main>
{%- endcapture -%}

{%- include base.html -%}